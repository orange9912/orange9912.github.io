---
title: 项目实践中的一些优化想法
date: 2021-07-18 16:03:43
tags:
categories:
- 前端
---

抽出一点时间来稍微总结一下平时编写项目中使用过的一些性能优化的手段，还有很多没有尝试过，那些以后再补充

# 通用代码方面

## 防抖、节流

这两个函数的实现方式不再赘述了，其实比较简单，都是利用闭包。

只是防抖是当事件触发一定时间内不再触发才执行，而节流是无论触发多少次一定时间内只执行一次。

**应用场景：**比如说某些可能高频触发的事件，监听输入框用户输入以实时搜索、监听宽度改变之类的一些地方。

## 尾递归/尾调用

把函数改写成尾调用/尾递归可以优化调用栈空间占用，具体看我那篇详细介绍的博客。

**用于一些可能深层递归的计算函数**

## 减少重排重绘

每次布局的改变都需要浏览器reflow和repaint，大量重排重绘会影响性能表现。

**手段有：**尽量统一修改样式，比如使用类来添加样式。尝试将修改样式的函数利用window.requestAnimationFrame来调用等。

## 事件委托

对于一个列表大量的同级元素进行事件监听的时候，由于涉及大量的创建和销毁操作，性能表现会较差。

可以利用事件委托，将事件监听器设置于他们的父元素上，利用事件e.target来获取到真正触发事件的元素

顺带一提e.currentTarget指向的是设置事件监听器的元素。

## 懒加载

有些不用马上加载的资源，可以等需要用到的时候再进行加载。

比如说图片，在视口之外的时候不加载，之内的时候才加载，一般都使用标签的.lazy属性就可以实现。

# 框架代码方面

## 减少不必要渲染

利用should Componentupdate来进行比较，定义无需进行更新的场景。

通常只是浅比较下一次的props和state的话，可以让组件继承Pure Component来代替手写该方法。

## 运行时代码去除内联函数

**优化场景：**当组件内存在函数声明的逻辑（比如使用箭头函数或用bind声明函数）或闭包变量时，组件每刷新一次都会生成一个新的函数和闭包变量。这种不必要的函数就叫做内联函数。

可以利用React的新特性useMemo和useCallback来将这些变量包裹。

useMemo和useCallback都会在组件第一次渲染时执行，之后会在其依赖的变量，也就是useMemo和useCallback第二个参数发生变化时再次执行。

useMemo返回缓存的变量，useCallback返回缓存的函数。

# 工程方面

## 分离入口中重复引入的模块

配置optimization中的splitChunks进行代码分离，可以将不同入口中分离重复引入的库，减少重复代码。

# 剩下的等待以后慢慢实践……